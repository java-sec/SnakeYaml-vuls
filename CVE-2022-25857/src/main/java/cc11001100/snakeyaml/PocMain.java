package cc11001100.snakeyaml;

import org.yaml.snakeyaml.Yaml;

import java.io.IOException;
import java.io.InputStream;

/**
 * @author CC11001100
 */
public class PocMain {

    public static void main(String[] args) throws IOException {

        String filepath = "clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504";
        Yaml yaml = new Yaml();
        InputStream inputStream = Thread.currentThread().getContextClassLoader().getResourceAsStream(filepath);
        Object o = yaml.load(inputStream);

        // Output:
        // Exception in thread "main" java.lang.StackOverflowError
        //	at org.yaml.snakeyaml.reader.StreamReader.ensureEnoughData(StreamReader.java:171)
        //	at org.yaml.snakeyaml.reader.StreamReader.peek(StreamReader.java:126)
        //	at org.yaml.snakeyaml.scanner.ScannerImpl.scanLineBreak(ScannerImpl.java:2363)
        //	at org.yaml.snakeyaml.scanner.ScannerImpl.scanToNextToken(ScannerImpl.java:1259)
        //	at org.yaml.snakeyaml.scanner.ScannerImpl.fetchMoreTokens(ScannerImpl.java:329)
        //	at org.yaml.snakeyaml.scanner.ScannerImpl.checkToken(ScannerImpl.java:251)
        //	at org.yaml.snakeyaml.parser.ParserImpl$ParseFlowMappingKey.produce(ParserImpl.java:861)
        //	at org.yaml.snakeyaml.parser.ParserImpl$ParseFlowMappingFirstKey.produce(ParserImpl.java:849)
        //	at org.yaml.snakeyaml.parser.ParserImpl.peekEvent(ParserImpl.java:166)
        //	at org.yaml.snakeyaml.parser.ParserImpl.checkEvent(ParserImpl.java:156)
        //	at org.yaml.snakeyaml.composer.Composer.composeMappingNode(Composer.java:281)
        //	at org.yaml.snakeyaml.composer.Composer.composeNode(Composer.java:188)
        //	at org.yaml.snakeyaml.composer.Composer.composeKeyNode(Composer.java:310)
        //	at org.yaml.snakeyaml.composer.Composer.composeMappingChildren(Composer.java:301)
        //	at org.yaml.snakeyaml.composer.Composer.composeMappingNode(Composer.java:286)
        //	at org.yaml.snakeyaml.composer.Composer.composeNode(Composer.java:188)
        //	at org.yaml.snakeyaml.composer.Composer.composeKeyNode(Composer.java:310)
        //	at org.yaml.snakeyaml.composer.Composer.composeMappingChildren(Composer.java:301)
        //	at org.yaml.snakeyaml.composer.Composer.composeMappingNode(Composer.java:286)
        //	at org.yaml.snakeyaml.composer.Composer.composeNode(Composer.java:188)
        //	at org.yaml.snakeyaml.composer.Composer.composeKeyNode(Composer.java:310)
        // ......

    }

}
